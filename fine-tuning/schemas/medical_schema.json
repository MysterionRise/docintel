{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://docintel.dev/schemas/medical_schema.json",
  "title": "Medical Document Schema",
  "description": "Schema for structured extraction from medical documents. Used for data generation and validation in DocIntel fine-tuning.",
  "type": "object",
  "required": ["document_type", "diagnoses", "summary"],
  "properties": {
    "document_type": {
      "type": "string",
      "enum": ["discharge_summary", "lab_report", "prescription", "referral", "progress_note"],
      "description": "The type of medical document being analyzed."
    },
    "patient_info": {
      "type": "object",
      "description": "Anonymized patient demographic information.",
      "properties": {
        "age": {
          "type": "string",
          "description": "Patient age or age range (e.g. '45', '40-50')."
        },
        "sex": {
          "type": "string",
          "enum": ["male", "female", "other", "unknown"],
          "description": "Patient biological sex."
        }
      },
      "additionalProperties": false
    },
    "diagnoses": {
      "type": "array",
      "description": "Clinical diagnoses identified in the document.",
      "items": {
        "type": "object",
        "required": ["name", "status"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the diagnosis."
          },
          "icd10": {
            "type": "string",
            "description": "ICD-10 code for the diagnosis (e.g. 'E11.9').",
            "pattern": "^[A-Z][0-9]{2}(\\.[0-9]{1,4})?$"
          },
          "status": {
            "type": "string",
            "enum": ["active", "resolved", "suspected"],
            "description": "Current clinical status of the diagnosis."
          }
        },
        "additionalProperties": false
      }
    },
    "medications": {
      "type": "array",
      "description": "Medications mentioned in the document.",
      "items": {
        "type": "object",
        "required": ["name"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Medication name (generic or brand)."
          },
          "dose": {
            "type": "string",
            "description": "Dosage amount and unit (e.g. '500mg')."
          },
          "frequency": {
            "type": "string",
            "description": "How often the medication is taken (e.g. 'twice daily', 'BID')."
          },
          "route": {
            "type": "string",
            "description": "Route of administration (e.g. 'oral', 'IV', 'topical')."
          }
        },
        "additionalProperties": false
      }
    },
    "procedures": {
      "type": "array",
      "description": "Medical procedures documented.",
      "items": {
        "type": "object",
        "required": ["name"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the procedure."
          },
          "date": {
            "type": "string",
            "description": "Date the procedure was performed. ISO 8601 format (YYYY-MM-DD) preferred."
          },
          "findings": {
            "type": "string",
            "description": "Results or findings from the procedure."
          }
        },
        "additionalProperties": false
      }
    },
    "lab_results": {
      "type": "array",
      "description": "Laboratory test results.",
      "items": {
        "type": "object",
        "required": ["test", "value"],
        "properties": {
          "test": {
            "type": "string",
            "description": "Name of the laboratory test."
          },
          "value": {
            "type": "string",
            "description": "Measured value of the test result."
          },
          "unit": {
            "type": "string",
            "description": "Unit of measurement (e.g. 'mg/dL', 'mmol/L')."
          },
          "flag": {
            "type": "string",
            "enum": ["normal", "high", "low", "critical"],
            "description": "Abnormality flag for the result."
          }
        },
        "additionalProperties": false
      }
    },
    "follow_up": {
      "type": "array",
      "description": "Recommended follow-up actions.",
      "items": {
        "type": "object",
        "required": ["action"],
        "properties": {
          "action": {
            "type": "string",
            "description": "Description of the follow-up action."
          },
          "timeframe": {
            "type": "string",
            "description": "When the follow-up should occur (e.g. '2 weeks', '3 months')."
          },
          "provider": {
            "type": "string",
            "description": "Specialist or provider for the follow-up."
          }
        },
        "additionalProperties": false
      }
    },
    "summary": {
      "type": "string",
      "description": "A concise clinical summary of the document covering key findings, diagnoses, treatments, and follow-up plan."
    }
  },
  "additionalProperties": false
}
